/* Enhanced styling for code blocks */

/* Code block container */
pre {
    background-color: #f8f9fa;
    border: 1px solid #eaecef;
    border-radius: 6px;
    padding: 16px;
    margin-bottom: 16px;
    overflow-x: auto;
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    position: relative;
}

/* Code inside pre */
pre code {
    background-color: transparent;
    border-radius: 0;
    padding: 0;
    margin: 0;
    white-space: pre !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
    word-break: normal !important;
    display: block;
    color: inherit;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

/* Đặt biệt cho code trong các preview container */
.markdown-preview pre {
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    word-break: normal !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
    overflow-x: auto !important;
}

.markdown-preview pre code {
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    word-break: normal !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
    display: block !important;
    min-width: 100%;
}

/* Force HTML code blocks to preserve whitespace */
pre code.language-html,
pre code.language-cshtml {
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
}

/* Additional utility classes for inline code */
:not(pre) > code {
    background-color: rgba(175, 184, 193, 0.2);
    border-radius: 3px;
    padding: 0.2em 0.4em;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

html[data-theme="dark"] :not(pre) > code {
    background-color: rgba(110, 118, 129, 0.4);
}

/* Override for any external CSS that might affect code blocks */
[data-preserve-whitespace="true"] {
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    word-break: normal !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
}

/* Dark theme support */
html[data-theme="dark"] pre {
    background-color: #2d333b;
    border-color: #444c56;
    color: #adbac7;
}

/* Add language indicators to code blocks */
pre[data-language]::before {
    content: attr(data-language);
    position: absolute;
    top: 0;
    right: 0;
    padding: 2px 8px;
    font-size: 12px;
    color: #666;
    background-color: #f1f1f1;
    border-bottom-left-radius: 4px;
    text-transform: uppercase;
}

html[data-theme="dark"] pre[data-language]::before {
    background-color: #444c56;
    color: #adbac7;
}

/* Add language attribute to pre elements */
.markdown-preview pre code.language-javascript + pre {
    data-language: "javascript";
}

.markdown-preview pre code.language-html + pre {
    data-language: "html";
}

.markdown-preview pre code.language-cshtml + pre {
    data-language: "cshtml";
}

.markdown-preview pre code.language-css + pre {
    data-language: "css";
}

.markdown-preview pre code.language-csharp + pre {
    data-language: "csharp";
}

.markdown-preview pre code.language-sql + pre {
    data-language: "sql";
}

.markdown-preview pre code.language-python + pre {
    data-language: "python";
}

.markdown-preview pre code.language-java + pre {
    data-language: "java";
}

/* Đảm bảo giữ nguyên định dạng với mọi cách hiển thị */
.content-area pre,
.question-body pre,
.answer-body pre {
    white-space: pre !important;
    word-break: keep-all !important;
    word-wrap: normal !important;
    overflow-x: auto !important;
}

/* Specific fixes for markdown editor preview */
.markdown-preview-active .markdown-preview pre,
.markdown-preview-active .markdown-preview code {
    white-space: pre !important;
    display: block;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
}

/* Override any external CSS that might affect code formatting */
.markdown-preview code, 
.question-body code, 
.answer-body code {
    white-space: pre !important;
    word-spacing: normal !important;
    word-break: keep-all !important;
    overflow-wrap: normal !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
}

/* Special rules for HTML and CSHTML */
pre code.language-html, 
pre code.language-cshtml {
    white-space: pre !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    word-break: normal !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
    display: block !important;
    color: #333 !important;
}

html[data-theme="dark"] pre code.language-html, 
html[data-theme="dark"] pre code.language-cshtml {
    color: #e2e8f0 !important;
}

/* Override any editor CSS that might affect these elements */
.markdown-preview pre[data-language="html"],
.markdown-preview pre[data-language="cshtml"] {
    background-color: #f8f9fa !important;
    border: 1px solid #eaecef !important;
    border-radius: 6px !important;
    padding: 16px !important;
    margin-bottom: 16px !important;
    overflow-x: auto !important;
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
    -o-tab-size: 4 !important;
    position: relative !important;
}

html[data-theme="dark"] .markdown-preview pre[data-language="html"],
html[data-theme="dark"] .markdown-preview pre[data-language="cshtml"] {
    background-color: #2d333b !important;
    border-color: #444c56 !important;
}